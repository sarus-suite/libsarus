inputs:
  image-name:
    description: "Container image name"

runs:
  using: "composite"
  steps:
    - name: Initialize git repository
      shell: bash
      run: git config --global --add safe.directory '*'

    - shell: bash
      run: echo $PATH

    - shell: bash
      run: which cmake

    - name: Change file permission
      shell: bash
      run: chown docker:docker $PWD/* -R

    - name: Run build script
      shell: bash
      run: sudo -u docker ./build.sh -DBUILD_DIR=$PWD/build

    - name: Upload build
      uses: actions/upload-artifact@v4
      with:
        name: build-${{ inputs.image-name }}
        path: ./build
